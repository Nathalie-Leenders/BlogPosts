<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>How to get conditional images in your Canvas app</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="//localhost:1313/styles/application.template.scss" integrity="" />





<meta property="og:url" content="//localhost:1313/posts/conditional-images-canvasapp/">
  <meta property="og:site_name" content="Power Platform Tips & Tricks">
  <meta property="og:title" content="How to get conditional images in your Canvas app">
  <meta property="og:description" content="Ever had a scenario, where someone wanted to have images in their app, but also pull them from a source somewhere? Let’s say, you want to reflect their office image in your app. But you also want to possibility to overwrite/upload your own instead.
You can do this by using an If statement and some variables, let’s look at the following scenario.
You work for a company called Powerplatform with their email domain @Powerplatform.com">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-11-07T14:27:14+00:00">
    <meta property="article:modified_time" content="2022-11-07T14:27:14+00:00">
    <meta property="article:tag" content="Variables">
    <meta property="article:tag" content="Images">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How to get conditional images in your Canvas app">
  <meta name="twitter:description" content="Ever had a scenario, where someone wanted to have images in their app, but also pull them from a source somewhere? Let’s say, you want to reflect their office image in your app. But you also want to possibility to overwrite/upload your own instead.
You can do this by using an If statement and some variables, let’s look at the following scenario.
You work for a company called Powerplatform with their email domain @Powerplatform.com">
      <meta name="twitter:site" content="@NathLeenders">

    
    
<meta name="description" content="How to get conditional images in your Canvas app" />



    





    <script integrity="sha256-6N/HdTRW44DtfcdqA1u42Z4XgmL1dEmNmLPaA2sgp1o=">
     let theme = localStorage.getItem('theme-scheme') || localStorage.getItem('darkmode:color-scheme') || 'light'
if (theme === 'system') {
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    theme = 'dark'
  } else {
    theme = 'light'
  }
}
document.documentElement.setAttribute('data-theme', theme)

    </script>
    
  </head>

  <body class="type-posts kind-page" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
    <div class="container-fluid bg-secondary wrapper">
      
      
    

































  


<nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="//localhost:1313/">
      Power Platform Tips &amp; Tricks</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="//localhost:1313/#home">Home</a>
        </li>
        
        
        
        
        
        
        
        
      </ul>
    </div>
  </div>
  
  
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="//localhost:1313/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="//localhost:1313/posts/" data-filter="all">Posts</a></li>
            <div class="subtree">
                

            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        
        <div class="author-profile ms-auto align-self-lg-center">
          <img class="rounded-circle" src='//localhost:1313/images/default-avatar_hu7082271500929968185.png' alt="Author Image">
          <h5 class="author-name"></h5>
          <p class="text-muted">Monday, November 7, 2022</p>
        </div>
        

        <div class="title">
          <h1>How to get conditional images in your Canvas app</h1>
        </div>

        

        
        <div class="post-content" id="post-content">
          <h1 id="ever-had-a-scenario-where-someone-wanted-to-have-images-in-their-app-but-also-pull-them-from-a-source-somewhere">Ever had a scenario, where someone wanted to have images in their app, but also pull them from a source somewhere?</h1>
<p>Let’s say, you want to reflect their office image in your app. But you also want to possibility to overwrite/upload your own instead.</p>
<p>You can do this by using an If statement and some variables, let’s look at the following scenario.</p>
<ul>
<li>
<p>You work for a company called Powerplatform with their email domain @Powerplatform.com</p>
</li>
<li>
<p>You want to reflect the office uploaded image in your app when someone submits something.</p>
</li>
<li>
<p>Add a button that searched for someone from your company, so you can switch between uploading your own image, or using their office picture.</p>
</li>
<li>
<p>Add an editform to your app with an image control and textfield for email</p>
</li>
<li>
<p>Add a button</p>
</li>
<li>
<p>On your datasources, add Office365Users to your app</p>
</li>
<li>
<p>On your Onselect from the button, add this statement:</p>
<pre tabindex="0"><code class="language-PowerFx" data-lang="PowerFx">If(!IsBlank(Find(&#34;@Powerplatform.com&#34;,DataCardValue1.Text)),

Set(VarOfficeImage,true),Set(VarOfficeImage,false));
</code></pre></li>
</ul>
<p>Make sure your datacardvalue matches the one in your email field. The variable will error but that’s fine as we’ll set that up now.</p>
<p>What this does, is if you have for example <code>Janedoe@Powerplatform.com</code> it sets your variable, I will now explain how this variable works.</p>
<ul>
<li>On your image datacard, find the image1 field, and go to the Image Property.</li>
<li>Paste the following code to your Image property:</li>
</ul>
<p><code>PowerFx</code>
<code>If(Form.Mode = FormMode.Edit,</code></p>
<p><code>Parent.Default,</code></p>
<p><code>VarOfficeImage=true,Office365Users.UserPhotoV2(DataCardValue1),</code></p>
<p><code> AddPicture1.Media)</code></p>
<p>What this does, if that if you’re in edit mode modifying someone, it grabs the parent (existing) image, otherwise if the variable for your office image is true (if you pushed the button) to grab the user photo for the person you have specified in your email address field.</p>
<p>If that variable is false (there is no match in the email field) you can add your own image through the regular image card.</p>
<h2 id="test-your-functionality-and-save-the-app">Test your functionality, and save the app</h2>
<p>I understand this seems very tricky, let me know if you have any questions.</p>

        </div>

        
        <div class="row ps-3 pe-3">
        
          <div class="col-md-6 share-buttons">
          
          </div>

        
        
        </div>



      
      <hr />
        












<div class="row next-prev-navigator">
  
  
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Scroll to top">
    <i class="fas fa-chevron-circle-up"></i>
  </a>
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    
    












  
  

  
  

  
  

  
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
        </div>
        
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
            
              <form method='post' action='https://blogtrottr.com'>
              <div class="form-group">
              <input type='email' class="form-control" name='btr_email' placeholder="Enter email"/><br />
              <input type='hidden' name='btr_url' value='//localhost:1313//index.xml' />
              <input type='hidden' name='schedule_type' value='1' />
              <small id="emailHelp" class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
              <button type="submit" class="btn btn-info"> Submit </button>
              </div>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="//localhost:1313/images/theme-logo_hu16779671404603505019.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">© 2025 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="//localhost:1313/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script src="//localhost:1313/scripts/application.js" integrity="" defer></script>


    
     

    
</body>
</html>
